<class name = "parch_msg" signature = "1" title = "transport for Switched Virtual Call messages">
This is the Switched Virtual Call protocol version 1
<license>
GPL3+, bitches
</license>

<!-- Protocol version -->
<define name = "VERSION" value = "1" />

<!-- Response codes -->
<declare>
// BEGIN DECLARE
// END DECLARE
</declare>

<message name = "DATA" id = "0">
Binary data message.
  <field name = "sequence" type = "number" size = "4" />
  <field name = "data" type = "frame" />
</message>

<message name = "RR" id = "1">
Tells peer the lowest send sequence number that it may send in its DATA packet.
  <field name = "sequence" type = "number" size = "4" />
</message>

<message name = "RNR" id = "5">
Tells peer to stop sending data.
  <field name = "sequence" type = "number" size = "4" />
</message>

<!-- message name = "REJ" id = "9" -->

<message name = "CALL_REQUEST" id = "13">
Call a peer. Negotiate the type of connection requested.
  <field name = "service" type = "string" />
  <field name = "outgoing" type = "number" size = "1" />
  <field name = "incoming" type = "number" size = "1" />
  <field name = "packet" type = "number" size = "1" />
  <field name = "window" type = "number" size = "1" />
  <field name = "throughput" type = "number" size = "1" />
</message>

<message name = "CALL_ACCEPTED" id = "15">
Answer the call.
  <field name = "outgoing" type = "number" size = "1" />
  <field name = "incoming" type = "number" size = "1" />
  <field name = "packet" type = "number" size = "1" />
  <field name = "window" type = "number" size = "1" />
</message>

<message name = "CLEAR_REQUEST" id = "19">
Request call termination
  <field name = "cause" type = "number" size = "1" />
  <field name = "diagnostic" type = "number" size = "1" />
</message>

<message name = "CLEAR_CONFIRMATION" id = "23">
Accept call termination
  <field name = "cause" type = "number" size = "1" />
  <field name = "diagnostic" type = "number" size = "1" />
</message>

<message name = "RESET_REQUEST" id = "27">
Tell the peer to restart flow control
  <field name = "cause" type = "number" size = "1" />
  <field name = "diagnostic" type = "number" size = "1" />
</message>

<message name = "RESET_CONFIRMATION" id = "31">
Tell the peer that we have restarted flow control
  <field name = "cause" type = "number" size = "1" />
  <field name = "diagnostic" type = "number" size = "1" />
</message>

<message name = "CONNECT" id = "43">
Client node requests connection to the broker.
  <field name = "protocol" type = "string" value = "PARCH" />
  <field name = "version" type = "number" size = "1" value = "PARCH_MSG_VERSION" />
  <field name = "service" type = "string" />
  <field name = "incoming" type = "number" size = "1" />
  <field name = "outgoing" type = "number" size = "1" />
  <field name = "throughput" type = "number" size = "1" />
</message>

<message name = "CONNECT_INDICATION" id = "45">
Broker tells node that it has been connected.
</message>

<message name = "DISCONNECT" id = "47">
Node tells broker that it is disconnecting.
</message>

<message name = "DISCONNECT_INDICATION" id = "49">
 Broker tells node that it has been disconnect
  <field name = "cause" type = "number" size = "1" />
  <field name = "diagnostic" type = "number" size = "1" />
</message>
</class>
